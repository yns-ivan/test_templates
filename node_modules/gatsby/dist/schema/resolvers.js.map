{"version":3,"file":"resolvers.js","names":["pathObjectToPathString","input","path","currentValue","leaf","undefined","isPlainObject","entries","Object","length","Error","key","value","push","join","getMaybeResolvedValue","node","field","nodeInterfaceName","fieldPathNeedToResolve","selector","type","getValueAt","getResolvedFields","findOne","typeName","findOneResolver","_source","args","context","info","stats","totalRunQuery","nodeModel","query","filter","schema","getType","tracer","maybeConvertSortInputObjectToSortPath","sort","sorts","Array","isArray","modifiedSort","fields","order","findManyPaginated","findManyPaginatedResolver","group","getProjectedField","distinct","max","min","sum","skip","Math","limit","extendedArgs","totalPluralRunQuery","result","findAll","connectionType","paginate","resultOffset","createDistinctResolver","distinctResolver","source","edges","values","Set","forEach","subValue","add","Date","toISOString","from","createMinResolver","minResolver","Number","MAX_SAFE_INTEGER","isNaN","createMaxResolver","maxResolver","MIN_SAFE_INTEGER","createSumResolver","sumResolver","reduce","prev","createGroupResolver","groupResolver","groupedResults","acc","concat","create","keys","fieldValue","GatsbyIterable","totalCount","results","params","allItems","start","items","slice","pageCount","count","ceil","currentPage","hasPreviousPage","hasNextPage","map","item","i","arr","next","previous","nodes","pageInfo","itemCount","perPage","link","options","by","fieldConfig","linkResolver","resolver","resolve","defaultFieldResolver","fieldValueOrPromise","fromNode","then","linkResolverValue","returnType","getNullableType","getNamedType","getNodesByIds","ids","getNodeById","id","runQueryArgs","split","reduceRight","obj","in","eq","firstOnly","GraphQLList","linkResolverQueryResult","queryResult","find","fileByPath","fileByPathResolver","parentFileNode","findRootNodeAncestor","internal","queryNodesByPath","relPaths","queryNodeByPath","relPath","absolutePath","normalize","systemPath","dir","fieldName","selectionSet","fieldNodes","getFieldNodeByNameInSelectionSet","isObjectType","isInterfaceType","getFields","fieldArg","arg","name","fieldTC","isEnumType","isInputObjectType","fieldNode","arguments","kind","Kind","ENUM","enumKey","enumValue","getValue","OBJECT","sortPath","selections","selection","FRAGMENT_SPREAD","fragmentDef","fragments","INLINE_FRAGMENT","property","WARNED_ABOUT_RESOLVERS","badResolverInvocationMessage","missingVar","resolverName","pathToArray","wrappingResolver","wrappedTracingResolver","parent","reporter","warn","activity","time","createResolverActivity","parentType","telemetryResolverTimings","process","hrtime","bigint","endActivity","duration","end","isTracingResolver","defaultResolver"],"sources":["../../src/schema/resolvers.ts"],"sourcesContent":["import systemPath from \"path\"\nimport normalize from \"normalize-path\"\nimport {\n  GraphQLList,\n  GraphQLType,\n  getNullableType,\n  getNamedType,\n  Kind,\n  GraphQLFieldConfig,\n  GraphQLResolveInfo,\n  isObjectType,\n  isInterfaceType,\n  isEnumType,\n  isInputObjectType,\n  SelectionSetNode,\n  SelectionNode,\n  FieldNode,\n} from \"graphql\"\nimport isPlainObject from \"lodash/isPlainObject\"\nimport { Path } from \"graphql/jsutils/Path\"\nimport reporter from \"gatsby-cli/lib/reporter\"\nimport { pathToArray } from \"../query/utils\"\nimport { getValueAt } from \"../utils/get-value-at\"\nimport {\n  GatsbyResolver,\n  IGatsbyConnection,\n  IGatsbyResolverContext,\n} from \"./type-definitions\"\nimport { IGatsbyNode } from \"../redux/types\"\nimport { IQueryResult } from \"../datastore/types\"\nimport { GatsbyIterable } from \"../datastore/common/iterable\"\nimport { getResolvedFields, fieldPathNeedToResolve } from \"./utils\"\n\ntype ResolvedLink = IGatsbyNode | Array<IGatsbyNode> | null\n\ntype nestedListOfStrings = Array<string | nestedListOfStrings>\ntype nestedListOfNodes = Array<IGatsbyNode | nestedListOfNodes>\n\ntype NestedPathStructure = INestedPathStructureNode | true | \"ASC\" | \"DESC\"\n\ninterface INestedPathStructureNode {\n  [key: string]: NestedPathStructure\n}\n\nfunction pathObjectToPathString(input: INestedPathStructureNode): {\n  path: string\n  leaf: any\n} {\n  const path: Array<string> = []\n  let currentValue: NestedPathStructure | undefined = input\n  let leaf: any = undefined\n  while (currentValue) {\n    if (isPlainObject(currentValue)) {\n      const entries = Object.entries(currentValue)\n      if (entries.length !== 1) {\n        throw new Error(`Invalid field arg`)\n      }\n      for (const [key, value] of entries) {\n        path.push(key)\n        currentValue = value\n      }\n    } else {\n      leaf = currentValue\n      currentValue = undefined\n    }\n  }\n\n  return {\n    path: path.join(`.`),\n    leaf,\n  }\n}\n\nexport function getMaybeResolvedValue(\n  node: IGatsbyNode,\n  field: string | INestedPathStructureNode,\n  nodeInterfaceName: string\n): any {\n  if (typeof field !== `string`) {\n    field = pathObjectToPathString(field).path\n  }\n\n  if (\n    fieldPathNeedToResolve({\n      selector: field,\n      type: nodeInterfaceName,\n    })\n  ) {\n    return getValueAt(getResolvedFields(node) as Record<string, unknown>, field)\n  } else {\n    return getValueAt(node, field)\n  }\n}\n\nexport function findOne<TSource, TArgs>(\n  typeName: string\n): GatsbyResolver<TSource, TArgs> {\n  return function findOneResolver(_source, args, context, info): any {\n    if (context.stats) {\n      context.stats.totalRunQuery++\n    }\n    return context.nodeModel.findOne(\n      {\n        query: { filter: args },\n        type: info.schema.getType(typeName),\n        stats: context.stats,\n        tracer: context.tracer,\n      },\n      { path: context.path }\n    )\n  }\n}\n\ntype PaginatedArgs<TArgs> = TArgs & { skip?: number; limit?: number; sort: any }\n\nfunction maybeConvertSortInputObjectToSortPath<TArgs>(\n  args: PaginatedArgs<TArgs>\n): any {\n  if (!args.sort) {\n    return args\n  }\n\n  if (_CFLAGS_.GATSBY_MAJOR === `5`) {\n    let sorts = args.sort\n    if (!Array.isArray(sorts)) {\n      sorts = [sorts]\n    }\n\n    const modifiedSort: any = {\n      fields: [],\n      order: [],\n    }\n\n    for (const sort of sorts) {\n      const { path, leaf } = pathObjectToPathString(sort)\n      modifiedSort.fields.push(path)\n      modifiedSort.order.push(leaf)\n    }\n\n    return {\n      ...args,\n      sort: modifiedSort,\n    }\n  }\n\n  return args\n}\n\nexport function findManyPaginated<TSource, TArgs>(\n  typeName: string\n): GatsbyResolver<TSource, PaginatedArgs<TArgs>> {\n  return async function findManyPaginatedResolver(\n    _source,\n    args,\n    context,\n    info\n  ): Promise<IGatsbyConnection<IGatsbyNode>> {\n    // Peek into selection set and pass on the `field` arg of `group` and\n    // `distinct` which might need to be resolved.\n    const group = getProjectedField(info, `group`)\n    const distinct = getProjectedField(info, `distinct`)\n    const max = getProjectedField(info, `max`)\n    const min = getProjectedField(info, `min`)\n    const sum = getProjectedField(info, `sum`)\n\n    // Apply paddings for pagination\n    // (for previous/next node and also to detect if there is a previous/next page)\n    const skip = typeof args.skip === `number` ? Math.max(0, args.skip - 1) : 0\n    const limit = typeof args.limit === `number` ? args.limit + 2 : undefined\n\n    const extendedArgs = {\n      ...maybeConvertSortInputObjectToSortPath(args),\n      group: group || [],\n      distinct: distinct || [],\n      max: max || [],\n      min: min || [],\n      sum: sum || [],\n      skip,\n      limit,\n    }\n    // Note: stats are passed to telemetry in src/commands/build.ts\n    if (context.stats) {\n      context.stats.totalRunQuery++\n      context.stats.totalPluralRunQuery++\n    }\n    const result = await context.nodeModel.findAll(\n      {\n        query: extendedArgs,\n        type: info.schema.getType(typeName),\n        stats: context.stats,\n        tracer: context.tracer,\n      },\n      { path: context.path, connectionType: typeName }\n    )\n    return paginate(result, {\n      resultOffset: skip,\n      skip: args.skip,\n      limit: args.limit,\n    })\n  }\n}\n\ninterface IFieldConnectionArgs {\n  field: string | INestedPathStructureNode\n}\n\nexport function createDistinctResolver(\n  nodeInterfaceName: string\n): GatsbyResolver<IGatsbyConnection<IGatsbyNode>, IFieldConnectionArgs> {\n  return function distinctResolver(source, args): Array<string> {\n    const { field } = args\n    const { edges } = source\n\n    const values = new Set<string>()\n    edges.forEach(({ node }) => {\n      const value = getMaybeResolvedValue(node, field, nodeInterfaceName)\n      if (value === null || value === undefined) {\n        return\n      }\n      if (Array.isArray(value)) {\n        value.forEach(subValue =>\n          values.add(\n            subValue instanceof Date ? subValue.toISOString() : subValue\n          )\n        )\n      } else if (value instanceof Date) {\n        values.add(value.toISOString())\n      } else {\n        values.add(value)\n      }\n    })\n    return Array.from(values).sort()\n  }\n}\n\nexport function createMinResolver(\n  nodeInterfaceName: string\n): GatsbyResolver<IGatsbyConnection<IGatsbyNode>, IFieldConnectionArgs> {\n  return function minResolver(source, args): number | null {\n    const { field } = args\n    const { edges } = source\n\n    let min = Number.MAX_SAFE_INTEGER\n\n    edges.forEach(({ node }) => {\n      let value = getMaybeResolvedValue(node, field, nodeInterfaceName)\n\n      if (typeof value !== `number`) {\n        value = Number(value)\n      }\n      if (!isNaN(value) && value < min) {\n        min = value\n      }\n    })\n    if (min === Number.MAX_SAFE_INTEGER) {\n      return null\n    }\n    return min\n  }\n}\n\nexport function createMaxResolver(\n  nodeInterfaceName: string\n): GatsbyResolver<IGatsbyConnection<IGatsbyNode>, IFieldConnectionArgs> {\n  return function maxResolver(source, args): number | null {\n    const { field } = args\n    const { edges } = source\n\n    let max = Number.MIN_SAFE_INTEGER\n\n    edges.forEach(({ node }) => {\n      let value = getMaybeResolvedValue(node, field, nodeInterfaceName)\n      if (typeof value !== `number`) {\n        value = Number(value)\n      }\n      if (!isNaN(value) && value > max) {\n        max = value\n      }\n    })\n    if (max === Number.MIN_SAFE_INTEGER) {\n      return null\n    }\n    return max\n  }\n}\n\nexport function createSumResolver(\n  nodeInterfaceName: string\n): GatsbyResolver<IGatsbyConnection<IGatsbyNode>, IFieldConnectionArgs> {\n  return function sumResolver(source, args): number | null {\n    const { field } = args\n    const { edges } = source\n\n    return edges.reduce<number | null>((prev, { node }) => {\n      let value = getMaybeResolvedValue(node, field, nodeInterfaceName)\n\n      if (typeof value !== `number`) {\n        value = Number(value)\n      }\n      if (!isNaN(value)) {\n        return (prev || 0) + value\n      }\n      return prev\n    }, null)\n  }\n}\n\ntype IGatsbyGroupReturnValue<NodeType> = Array<\n  IGatsbyConnection<NodeType> & {\n    field: string\n    fieldValue: string | undefined\n  }\n>\n\nexport function createGroupResolver(\n  nodeInterfaceName: string\n): GatsbyResolver<\n  IGatsbyConnection<IGatsbyNode>,\n  PaginatedArgs<IFieldConnectionArgs>\n> {\n  return function groupResolver(\n    source,\n    args\n  ): IGatsbyGroupReturnValue<IGatsbyNode> {\n    const { field } = args\n    const { edges } = source\n    const groupedResults: Record<string, Array<IGatsbyNode>> = edges.reduce(\n      (acc, { node }) => {\n        const value = getMaybeResolvedValue(node, field, nodeInterfaceName)\n        const values = Array.isArray(value) ? value : [value]\n        values\n          .filter(value => value != null)\n          .forEach(value => {\n            const key = value instanceof Date ? value.toISOString() : value\n            acc[key] = (acc[key] || []).concat(node)\n          })\n        return acc\n        // Note: using Object.create on purpose:\n        //   object key may be arbitrary string including reserved words (i.e. `constructor`)\n        //   see: https://github.com/gatsbyjs/gatsby/issues/22508\n      },\n      Object.create(null)\n    )\n\n    return Object.keys(groupedResults)\n      .sort()\n      .reduce(\n        (acc: IGatsbyGroupReturnValue<IGatsbyNode>, fieldValue: string) => {\n          const entries = groupedResults[fieldValue] || []\n          acc.push({\n            ...paginate(\n              {\n                entries: new GatsbyIterable(entries),\n                totalCount: async () => entries.length,\n              },\n              args\n            ),\n            field:\n              typeof field === `string`\n                ? field\n                : pathObjectToPathString(field).path,\n            fieldValue,\n          })\n          return acc\n        },\n        []\n      )\n  }\n}\n\nexport function paginate(\n  results: IQueryResult,\n  params: { skip?: number; limit?: number; resultOffset?: number }\n): IGatsbyConnection<IGatsbyNode> {\n  const { resultOffset = 0, skip = 0, limit } = params\n  if (resultOffset > skip) {\n    throw new Error(\"Result offset cannot be greater than `skip` argument\")\n  }\n  const allItems = Array.from(results.entries)\n\n  const start = skip - resultOffset\n  const items = allItems.slice(start, limit && start + limit)\n\n  const totalCount = results.totalCount\n  const pageCount = async (): Promise<number> => {\n    const count = await totalCount()\n    return limit\n      ? Math.ceil(skip / limit) + Math.ceil((count - skip) / limit)\n      : skip\n      ? 2\n      : 1\n  }\n  const currentPage = limit ? Math.ceil(skip / limit) + 1 : skip ? 2 : 1\n  const hasPreviousPage = currentPage > 1\n  const hasNextPage = limit ? allItems.length - start > limit : false\n\n  return {\n    totalCount,\n    edges: items.map((item, i, arr) => {\n      return {\n        node: item,\n        next: arr[i + 1],\n        previous: arr[i - 1],\n      }\n    }),\n    nodes: items,\n    pageInfo: {\n      currentPage,\n      hasPreviousPage,\n      hasNextPage,\n      itemCount: items.length,\n      pageCount,\n      perPage: limit,\n      totalCount,\n    },\n  }\n}\n\nexport function link<TSource, TArgs>(\n  options: {\n    by: string\n    type?: GraphQLType\n    from?: string\n    fromNode?: boolean\n  } = {\n    by: `id`,\n  },\n  fieldConfig: GraphQLFieldConfig<\n    TSource,\n    IGatsbyResolverContext<TSource, TArgs>,\n    TArgs\n  >\n): GatsbyResolver<TSource, TArgs> {\n  // Note: we explicitly make an attempt to prevent using the `async` keyword because often\n  //       it does not return a promise and this makes a significant difference at scale.\n\n  return function linkResolver(\n    source,\n    args,\n    context,\n    info\n  ): ResolvedLink | Promise<ResolvedLink> {\n    const resolver = fieldConfig.resolve || context.defaultFieldResolver\n    const fieldValueOrPromise = resolver(source, args, context, {\n      ...info,\n      from: options.from || info.from,\n      fromNode: options.from ? options.fromNode : info.fromNode,\n    })\n\n    // Note: for this function, at scale, conditional .then is more efficient than generic await\n    if (typeof fieldValueOrPromise?.then === `function`) {\n      return fieldValueOrPromise.then(fieldValue =>\n        linkResolverValue(fieldValue, args, context, info)\n      )\n    }\n\n    return linkResolverValue(fieldValueOrPromise, args, context, info)\n  }\n\n  function linkResolverValue(\n    fieldValue,\n    args,\n    context,\n    info\n  ): ResolvedLink | Promise<ResolvedLink> {\n    if (fieldValue == null) {\n      return null\n    }\n\n    const returnType = getNullableType(options.type || info.returnType)\n    const type = getNamedType(returnType)\n\n    if (options.by === `id`) {\n      if (Array.isArray(fieldValue)) {\n        return context.nodeModel.getNodesByIds(\n          { ids: fieldValue, type: type },\n          { path: context.path }\n        )\n      } else {\n        return context.nodeModel.getNodeById(\n          { id: fieldValue, type: type },\n          { path: context.path }\n        )\n      }\n    }\n\n    // Return early if fieldValue is [] since { in: [] } doesn't make sense\n    if (Array.isArray(fieldValue) && fieldValue.length === 0) {\n      return fieldValue\n    }\n\n    const runQueryArgs = args as TArgs & { filter: Record<string, any> }\n    runQueryArgs.filter = options.by.split(`.`).reduceRight(\n      (acc: Record<string, any>, key: string) => {\n        const obj = {}\n        obj[key] = acc\n        return obj\n      },\n      Array.isArray(fieldValue) ? { in: fieldValue } : { eq: fieldValue }\n    )\n\n    const firstOnly = !(returnType instanceof GraphQLList)\n\n    if (context.stats) {\n      context.stats.totalRunQuery++\n      if (firstOnly) {\n        context.stats.totalPluralRunQuery++\n      }\n    }\n\n    if (firstOnly) {\n      return context.nodeModel\n        .findOne(\n          {\n            query: runQueryArgs,\n            type,\n            stats: context.stats,\n            tracer: context.tracer,\n          },\n          { path: context.path }\n        )\n        .then(result => linkResolverQueryResult(fieldValue, result, returnType))\n    }\n\n    return context.nodeModel\n      .findAll(\n        {\n          query: runQueryArgs,\n          type,\n          stats: context.stats,\n          tracer: context.tracer,\n        },\n        { path: context.path }\n      )\n      .then(({ entries }) =>\n        linkResolverQueryResult(fieldValue, Array.from(entries), returnType)\n      )\n  }\n\n  function linkResolverQueryResult(\n    fieldValue,\n    queryResult,\n    returnType\n  ): IGatsbyNode | Array<IGatsbyNode> {\n    if (\n      returnType instanceof GraphQLList &&\n      Array.isArray(fieldValue) &&\n      Array.isArray(queryResult)\n    ) {\n      return fieldValue.map(value =>\n        queryResult.find(obj => getValueAt(obj, options.by) === value)\n      )\n    } else {\n      return queryResult\n    }\n  }\n}\n\nexport function fileByPath<TSource, TArgs>(\n  options: {\n    from?: string\n    fromNode?: boolean\n  } = {},\n  fieldConfig\n): GatsbyResolver<TSource, TArgs> {\n  return async function fileByPathResolver(\n    source,\n    args,\n    context,\n    info\n  ): Promise<IGatsbyNode | nestedListOfNodes | null> {\n    const resolver = fieldConfig.resolve || context.defaultFieldResolver\n    const fieldValue: nestedListOfStrings = await resolver(\n      source,\n      args,\n      context,\n      {\n        ...info,\n        from: options.from || info.from,\n        fromNode: options.from ? options.fromNode : info.fromNode,\n      }\n    )\n\n    if (fieldValue == null) {\n      return null\n    }\n\n    // Find the File node for this node (we assume the node is something\n    // like markdown which would be a child node of a File node).\n    const parentFileNode = context.nodeModel.findRootNodeAncestor(\n      source,\n      node => node.internal && node.internal.type === `File`\n    )\n\n    async function queryNodesByPath(\n      relPaths: nestedListOfStrings\n    ): Promise<nestedListOfNodes> {\n      const arr: nestedListOfNodes = []\n      for (let i = 0; i < relPaths.length; ++i) {\n        arr[i] = await (Array.isArray(relPaths[i])\n          ? queryNodesByPath(relPaths[i] as nestedListOfStrings)\n          : queryNodeByPath(relPaths[i] as string))\n      }\n      return arr\n    }\n\n    function queryNodeByPath(relPath: string): Promise<IGatsbyNode> {\n      return context.nodeModel.findOne({\n        query: {\n          filter: {\n            absolutePath: {\n              eq: normalize(systemPath.resolve(parentFileNode.dir, relPath)),\n            },\n          },\n        },\n        type: `File`,\n      })\n    }\n\n    if (Array.isArray(fieldValue)) {\n      return queryNodesByPath(fieldValue)\n    } else {\n      return queryNodeByPath(fieldValue)\n    }\n  }\n}\n\nfunction getProjectedField(\n  info: GraphQLResolveInfo,\n  fieldName: string\n): Array<string> {\n  const selectionSet = info.fieldNodes[0].selectionSet\n  if (selectionSet) {\n    const fieldNodes = getFieldNodeByNameInSelectionSet(\n      selectionSet,\n      fieldName,\n      info\n    )\n\n    if (fieldNodes.length === 0) {\n      return []\n    }\n\n    const returnType = getNullableType(info.returnType)\n\n    if (isObjectType(returnType) || isInterfaceType(returnType)) {\n      const field = returnType.getFields()[fieldName]\n      const fieldArg = field?.args?.find(arg => arg.name === `field`)\n      if (fieldArg) {\n        const fieldTC = getNullableType(fieldArg.type)\n\n        if (isEnumType(fieldTC) || isInputObjectType(fieldTC)) {\n          return fieldNodes.reduce(\n            (acc: Array<string>, fieldNode: FieldNode) => {\n              const fieldArg = fieldNode.arguments?.find(\n                arg => arg.name.value === `field`\n              )\n              if (isEnumType(fieldTC)) {\n                if (fieldArg?.value.kind === Kind.ENUM) {\n                  const enumKey = fieldArg.value.value\n                  const enumValue = fieldTC.getValue(enumKey)\n                  if (enumValue) {\n                    acc.push(enumValue.value)\n                  }\n                }\n              } else if (isInputObjectType(fieldTC)) {\n                const path: Array<string> = []\n                let currentValue = fieldArg?.value\n                while (currentValue) {\n                  if (currentValue.kind === Kind.OBJECT) {\n                    if (currentValue.fields.length !== 1) {\n                      throw new Error(`Invalid field arg`)\n                    }\n\n                    const fieldArg = currentValue.fields[0]\n                    path.push(fieldArg.name.value)\n                    currentValue = fieldArg.value\n                  } else {\n                    currentValue = undefined\n                  }\n                }\n\n                if (path.length > 0) {\n                  const sortPath = path.join(`.`)\n                  acc.push(sortPath)\n                }\n              }\n              return acc\n            },\n            []\n          )\n        }\n      }\n    }\n  }\n\n  return []\n}\n\nfunction getFieldNodeByNameInSelectionSet(\n  selectionSet: SelectionSetNode,\n  fieldName: string,\n  info: GraphQLResolveInfo\n): Array<FieldNode> {\n  return selectionSet.selections.reduce(\n    (acc: Array<FieldNode>, selection: SelectionNode) => {\n      if (selection.kind === Kind.FRAGMENT_SPREAD) {\n        const fragmentDef = info.fragments[selection.name.value]\n        if (fragmentDef) {\n          return [\n            ...acc,\n            ...getFieldNodeByNameInSelectionSet(\n              fragmentDef.selectionSet,\n              fieldName,\n              info\n            ),\n          ]\n        }\n      } else if (selection.kind === Kind.INLINE_FRAGMENT) {\n        return [\n          ...acc,\n          ...getFieldNodeByNameInSelectionSet(\n            selection.selectionSet,\n            fieldName,\n            info\n          ),\n        ]\n      } /* FIELD_NODE */ else {\n        if (selection.name.value === fieldName) {\n          return [...acc, selection]\n        }\n      }\n      return acc\n    },\n    []\n  )\n}\n\nexport const defaultFieldResolver: GatsbyResolver<any, any> =\n  function defaultFieldResolver(source, args, context, info) {\n    if (\n      (typeof source == `object` && source !== null) ||\n      typeof source === `function`\n    ) {\n      if (info.from) {\n        if (info.fromNode) {\n          const node = context.nodeModel.findRootNodeAncestor(source)\n          if (!node) return null\n          return getValueAt(node, info.from)\n        }\n        return getValueAt(source, info.from)\n      }\n      const property = source[info.fieldName]\n      if (typeof property === `function`) {\n        return source[info.fieldName](args, context, info)\n      }\n      return property\n    }\n\n    return null\n  }\n\nlet WARNED_ABOUT_RESOLVERS = false\nfunction badResolverInvocationMessage(missingVar: string, path?: Path): string {\n  const resolverName = path ? `${pathToArray(path)} ` : ``\n  return `GraphQL Resolver ${resolverName}got called without \"${missingVar}\" argument. This might cause unexpected errors.\n\nIt's likely that this has happened in a schemaCustomization with manually invoked resolver. If manually invoking resolvers, it's best to invoke them as follows:\n\n  resolve(parent, args, context, info)\n\n`\n}\n\nexport function wrappingResolver<TSource, TArgs>(\n  resolver: GatsbyResolver<TSource, TArgs>\n): GatsbyResolver<TSource, TArgs> {\n  // Note: we explicitly make an attempt to prevent using the `async` keyword because often\n  //       it does not return a promise and this makes a significant difference at scale.\n  //       GraphQL will gracefully handle the resolver result of a promise or non-promise.\n\n  if (resolver[`isTracingResolver`]) {\n    return resolver\n  }\n\n  const wrappedTracingResolver = function wrappedTracingResolver(\n    parent,\n    args,\n    context,\n    info\n  ): Promise<any> {\n    if (!WARNED_ABOUT_RESOLVERS) {\n      if (!info) {\n        reporter.warn(badResolverInvocationMessage(`info`))\n        WARNED_ABOUT_RESOLVERS = true\n      } else if (!context) {\n        reporter.warn(badResolverInvocationMessage(`context`, info.path))\n        WARNED_ABOUT_RESOLVERS = true\n      }\n    }\n\n    let activity\n    let time\n    if (context?.tracer) {\n      activity = context.tracer.createResolverActivity(\n        info.path,\n        `${info.parentType.name}.${info.fieldName}`\n      )\n      activity.start()\n    }\n    if (context?.telemetryResolverTimings) {\n      time = process.hrtime.bigint()\n    }\n\n    const result = resolver(parent, args, context, info)\n\n    if (!activity && !time) {\n      return result\n    }\n\n    const endActivity = (): void => {\n      if (context?.telemetryResolverTimings) {\n        context.telemetryResolverTimings.push({\n          name: `${info.parentType}.${info.fieldName}`,\n          duration: Number(process.hrtime.bigint() - time) / 1000 / 1000,\n        })\n      }\n      if (activity) {\n        activity.end()\n      }\n    }\n    if (typeof result?.then === `function`) {\n      result.then(endActivity, endActivity)\n    } else {\n      endActivity()\n    }\n    return result\n  }\n\n  wrappedTracingResolver.isTracingResolver = true\n\n  return wrappedTracingResolver\n}\n\nexport const defaultResolver = wrappingResolver(defaultFieldResolver)\n"],"mappings":"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"}